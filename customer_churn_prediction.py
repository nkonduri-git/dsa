# -*- coding: utf-8 -*-
"""Customer_Churn_Prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1_8aPV89fdJi0k0XhqoX0CQKWqhUkLIVn
"""

import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import accuracy_score, classification_report

print("Customer Churn Prediction - Minimal Version")
print("="*50)

# Create sample data
print("\n1. Creating data...")
np.random.seed(42)
n = 1000

df = pd.DataFrame({
    'age': np.random.randint(20, 70, n),
    'tenure': np.random.randint(1, 72, n),
    'monthly_charge': np.random.uniform(30, 100, n),
    'support_calls': np.random.randint(0, 10, n),
    'contract_monthly': np.random.randint(0, 2, n),
})

# Create target
df['churn'] = (
    (df['tenure'] < 12) * 0.3 +
    (df['contract_monthly'] == 1) * 0.3 +
    (df['support_calls'] > 4) * 0.2 +
    (df['monthly_charge'] > 70) * 0.2
) > 0.5

print(f"Created {len(df)} customers")
print(f"Churn rate: {df['churn'].mean():.1%}")

# Split data
print("\n2. Splitting data...")
X = df.drop('churn', axis=1)
y = df['churn']

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

print(f"Training: {len(X_train)}, Testing: {len(X_test)}")

# Train model
print("\n3. Training model...")
model = RandomForestClassifier(n_estimators=100, random_state=42)
model.fit(X_train, y_train)
print("âœ“ Training complete")

# Evaluate
print("\n4. Evaluating...")
y_pred = model.predict(X_test)
accuracy = accuracy_score(y_test, y_pred)

print(f"\nAccuracy: {accuracy:.2%}")
print("\nClassification Report:")
print(classification_report(y_test, y_pred, target_names=['Stay', 'Churn']))

# Feature importance
print("\n5. Feature Importance:")
for feature, importance in zip(X.columns, model.feature_importances_):
    print(f"  {feature:20s}: {importance:.4f}")

# Example prediction
print("\n6. Example Prediction:")
sample = [[35, 6, 85.0, 5, 1]]  # age, tenure, charge, calls, monthly_contract
prob = model.predict_proba(sample)[0][1]
pred = model.predict(sample)[0]

print(f"  Customer: Age 35, Tenure 6mo, Charge $85, 5 calls, Monthly contract")
print(f"  Churn Probability: {prob:.1%}")
print(f"  Prediction: {'WILL CHURN' if pred else 'WILL STAY'}")

print("\n" + "="*50)
print("Complete!")
print("="*50)